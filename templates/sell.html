{% extends "base.html" %}

{% block imports %}
  {{ block.super }}
  <style type="text/css">
    div#map_canvas {
      width: 300px;
      height: 300px;
      border: 1px solid black;
    }
  </style>
{% endblock %}

{% block content %}
<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}css/sell.css" />
<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}css/greyout.css" />

<input type="submit" value="New Listing" onclick="showGreyoutDialog();">

<!-- Stuff for new listings -->
<div class="greyout greyout-visible"></div>
<div id="new-listing" class="greyout-visible">
  <form enctype='multipart/form-data' action="{{ SITE_ROOT }}sell" method="post">
    {% csrf_token %}
    {{ form.as_p }}
    <input type="submit" value="Create Listing" />
  </form>

  <div id="map_canvas">

  </div>

  <div id="lat" style="display: none;">{{ latitude }}</div>
  <div id="lng" style="display: none;">{{ longitude }}</div>
  <input type="submit" value="Cancel" onclick="hideGreyoutDialog();">
</div>

<!-- Existing listings -->
<h2>My Listings</h2>
{% for item in items %}
  <div class="sell-item">
    <div class="sell-item-image-holder">
      {% if item.image %}
        <img class="sell-item-image" src="{{ item.image.url }}" alt="No image available" />
      {% else %}
        (No image available)
      {% endif %}
    </div>
    <div class="sell-item-name">
      {{ item.name }}
    </div>
    <div class="sell-item-description">
      {{ item.description }}
    </div>
    <div class="sell-item-price">
      ${{ item.price }}
    </div>
    <div class="sell-item-remove-button">
      <form name="sell_item" action="{{ SITE_ROOT }}remove_item" method="post">
        {% csrf_token %}
        <input type="hidden" name="item_id" value={{ item.id }}>
        <input type="submit" value="Remove">
      </form>
    </div>
  </div>
{% endfor %}

{% endblock %}

{% block js_extra_imports %}
<script
  type="text/javascript"
  src="http://maps.googleapis.com/maps/api/js?key=AIzaSyBAomHvVoRCbc7MW7p0IpnJdSgGcFlbMUA&sensor=false">
</script>
<script
  type="text/javascript"
  src="{{ STATIC_URL }}js/google_maps.js">
</script>
<script src="{{ STATIC_URL }}js/greyout_dialog.js"
    type="text/javascript"
    charset="utf8"></script>
{% endblock %}
